function loadSingle(e){console.log("incrementID: "+e);e>max?currentID=1:e<1?currentID=max:currentID=e;console.log("targetID: "+currentID);var t=url+"/"+currentID;$("#lightbox").load(t,function(){art=$(".artifact","#lightbox");$("#footer").find("p").remove();$("#footer").prepend(art);$(".artifact","#lightbox").remove();$(".ship_section img").load(function(e){var t=this.src,n=String("url("+t+")"),r={};r["background-image"]=n;console.log("resizing single images");var i=500,s=525,t=this.src,o=1,u=this.width,a=this.height;o=u>a?i/u:s/a;var f=u*o,l=a*o;r.height=l;r.width=f;var c=String(f)+"px "+String(l)+"px";r["background-size"]=c;r.visibility="visible";r.opacity="1";$(this).parent().css(r);$(this).remove();$("#lightbox").addClass("active")})})}function shipclick(){if(!scrolling){var e=$(this).attr("id");$("#container").removeClass("active");loadSingle(e)}}var url="http://server.local:8080/story",max=9,scrolling=!1,currentID,art;$("#tips").cycle({fx:"scrollHorz"});$("body").on("click",".ship_section",shipclick);var t;$(".dragon").scroll(function(){function e(){scrolling=!1;console.log("scrollend");clearInterval(t)}if(!scrolling){scrolling=!0;console.log("scroll start")}console.log("scrolling");clearInterval(t);t=window.setInterval(function(){e()},400)});$("body").on("click",".arr",function(){var e=$(this).attr("id")=="prev"?-1:1,t=parseInt(currentID)+e;console.log("changing page, direction = "+e+" next ID = "+t);loadSingle(t)});$("body").on("click","#close",function(){$("#footer").find("p").remove();$("#lightbox").removeClass("active");$("#container").addClass("active");console.log("closing lightbox")});$("#content").load(url,function(){pad=parseInt($(".ship_section").css("margin"));var e=$(this).width()/3-2*pad,t=$(this).height()/5;console.log("max: "+e+"x"+t);$("img").load(function(t){var n={},r=this.src,i=String("url("+r+")");n["background-image"]=i;var s=0,o=this.width,u=this.height;s=e/o;console.log("scale:"+s);var a=e,f=u*s,l=String(a)+"px "+String(f)+"px";n["background-size"]=l;n.height=f;n.width=a;n.visibility="visible";n.opacity="1";$(this).parent().css(n);$(this).remove()})});